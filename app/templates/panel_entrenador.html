{% extends "layout.html" %}
{% block title %}Panel entrenador{% endblock %}

{% block content %}
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
    <div>
      <div class="section-title">COACH</div>
      <h2 class="mb-0 text-strong">Panel del Entrenador</h2>
      <div class="text-soft mt-1">Rutinas, banco de ejercicios y gestiÃ³n de atletas.</div>
    </div>

    <div class="d-flex gap-2 flex-wrap">
      <a class="btn btn-outline-info" href="{{ url_for('main.coach_planificador') }}">ðŸ“… Planificador</a>
      <a class="btn btn-info" href="{{ url_for('main.admin_nuevo_atleta') }}">âž• Crear atleta</a>
    </div>
  </div>

  <div class="row g-3">

    <!-- ATLETAS -->
    <div class="col-lg-5">
      <div class="card glass p-3 lift">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="section-title">ATLETAS</div>
          <span class="badge bg-info">{{ atletas|length }}</span>
        </div>

        {% if atletas %}
          <div class="d-flex flex-column gap-2">
            {% for a in atletas %}
              <div class="item-row d-flex justify-content-between align-items-center">
                <div>
                  <div class="text-strong">{{ a.nombre }}</div>
                  <div class="text-soft" style="font-size:.9rem;">
                    {{ a.email }}{% if a.grupo %} Â· {{ a.grupo }}{% endif %}
                  </div>
                </div>
                <div class="d-flex gap-2">
                  <a class="btn btn-sm btn-outline-info" href="{{ url_for('main.perfil_usuario', user_id=a.id) }}">
                    Ver perfil
                  </a>
                  <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                        onsubmit="return confirm('Â¿Eliminar atleta y TODO su historial?');">
                    <button class="btn btn-sm btn-outline-danger" type="submit">Eliminar</button>
                  </form>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="empty-state">
            <div class="text-strong">No hay atletas todavÃ­a</div>
            <div class="text-soft">CreÃ¡ el primero para arrancar.</div>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- RUTINAS -->
    <div class="col-lg-7">
      <div class="card glass p-3 lift mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="section-title">RUTINAS</div>
          <span class="badge bg-secondary">{{ rutinas|length }}</span>
        </div>

        <form class="row g-2" method="POST" action="{{ url_for('main.crear_rutina') }}">
          <div class="col-md-4">
            <input class="form-control" name="nombre" placeholder="Nombre rutina" required>
          </div>
          <div class="col-md-3">
            <input class="form-control" name="tipo" placeholder="Tipo (Fuerza/Run/etc)">
          </div>
          <div class="col-md-3">
            <input class="form-control" name="descripcion" placeholder="DescripciÃ³n">
          </div>
          <div class="col-md-2 d-grid">
            <button class="btn btn-primary" type="submit">Crear</button>
          </div>
        </form>

        <hr class="my-3">

        {% if rutinas %}
          <div class="d-flex flex-column gap-2">
            {% for r in rutinas[:12] %}
              <div class="item-row d-flex justify-content-between align-items-center">
                <div>
                  <div class="text-strong">{{ r.nombre }}</div>
                  <div class="text-soft" style="font-size:.9rem;">
                    {% if r.tipo %}{{ r.tipo }}{% else %}â€”{% endif %}
                    {% if r.descripcion %} Â· {{ r.descripcion }}{% endif %}
                  </div>
                </div>
                <a class="btn btn-sm btn-outline-light" href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">
                  Builder
                </a>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="empty-state">
            <div class="text-strong">TodavÃ­a no hay rutinas</div>
            <div class="text-soft">CreÃ¡ una y armala con el builder.</div>
          </div>
        {% endif %}
      </div>

      <!-- BANCO EJERCICIOS -->
      <div class="card glass p-3 lift">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="section-title">BANCO DE EJERCICIOS</div>
          <span class="badge bg-secondary">{{ ejercicios|length }}</span>
        </div>

        <form class="row g-2" method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data">
          <div class="col-md-4">
            <input class="form-control" name="nombre" placeholder="Nombre ejercicio" required>
          </div>
          <div class="col-md-3">
            <input class="form-control" name="categoria" placeholder="CategorÃ­a">
          </div>
          <div class="col-md-3">
            <input class="form-control" type="file" name="video" required>
          </div>
          <div class="col-md-2 d-grid">
            <button class="btn btn-info" type="submit">Subir</button>
          </div>
          <div class="col-12">
            <input class="form-control" name="descripcion" placeholder="DescripciÃ³n (opcional)">
          </div>
        </form>
      </div>
    </div>

  </div>
</div>
{% endblock %}
