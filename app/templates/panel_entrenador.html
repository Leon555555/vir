{% extends "layout.html" %}
{% block title %}Panel Entrenador â€” VR Training{% endblock %}

{% block content %}
<div class="container">

  <div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3">
    <div>
      <h2 class="text-light mb-0">ğŸ§  Panel del entrenador</h2>
      <div class="text-muted">Rutinas Â· Banco de ejercicios Â· Atletas</div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-info" href="{{ url_for('main.coach_planificador') }}">ğŸ“… Ir al planificador</a>
    </div>
  </div>

  <div class="row g-3">
    <!-- ATLETAS -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="text-light mb-3">ğŸ‘¥ Atletas</h5>

        {% if atletas %}
          <div class="list-group">
            {% for a in atletas %}
              <div class="list-group-item bg-transparent text-light" style="border-color:rgba(255,255,255,.08)">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <div class="fw-bold">{{ a.nombre }}</div>
                    <div class="text-muted small">{{ a.email }}</div>
                  </div>
                  <div class="d-flex gap-2">
                    <a class="btn btn-sm btn-outline-info"
                       href="{{ url_for('main.perfil_usuario', user_id=a.id) }}">
                      Ver perfil
                    </a>
                    <a class="btn btn-sm btn-info"
                       href="{{ url_for('main.coach_planificador', user_id=a.id) }}">
                      Planificar
                    </a>
                    <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                          onsubmit="return confirm('Â¿Eliminar atleta {{ a.nombre }}?');">
                      <button class="btn btn-sm btn-outline-danger" type="submit">ğŸ—‘</button>
                    </form>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-muted">No hay atletas todavÃ­a.</div>
        {% endif %}
      </div>
    </div>

    <!-- RUTINAS -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="text-light mb-3">ğŸ‹ï¸ Rutinas</h5>

        <form method="POST" action="{{ url_for('main.crear_rutina') }}" class="mb-3">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre rutina" required>
          <input class="form-control mb-2" name="tipo" placeholder="Tipo (Fullbody, Pierna, etc)">
          <textarea class="form-control mb-2" name="descripcion" rows="2" placeholder="DescripciÃ³n"></textarea>
          <button class="btn btn-primary w-100" type="submit">â• Crear rutina</button>
        </form>

        <div class="list-group">
          {% for r in rutinas %}
            <a class="list-group-item bg-transparent text-light"
               style="border-color:rgba(255,255,255,.08)"
               href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-bold">{{ r.nombre }}</div>
                  <div class="text-muted small">{{ r.tipo or '' }}</div>
                </div>
                <span class="badge bg-info">Editar</span>
              </div>
            </a>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- EJERCICIOS -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="text-light mb-3">ğŸ¬ Banco de ejercicios</h5>

        <form method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data" class="mb-3">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre ejercicio" required>
          <input class="form-control mb-2" name="categoria" placeholder="CategorÃ­a (pierna, core, etc)">
          <textarea class="form-control mb-2" name="descripcion" rows="2" placeholder="DescripciÃ³n (opcional)"></textarea>
          <input class="form-control mb-2" type="file" name="video" accept="video/mp4" required>
          <button class="btn btn-success w-100" type="submit">â¬† Subir video</button>
        </form>

        <div class="text-muted small">Ãšltimos ejercicios subidos</div>
        <div class="list-group mt-2" style="max-height:420px;overflow:auto">
          {% for e in ejercicios %}
            <div class="list-group-item bg-transparent text-light" style="border-color:rgba(255,255,255,.08)">
              <div class="fw-bold">{{ e.nombre }}</div>
              <div class="text-muted small">{{ e.categoria or '' }}</div>
              {% if e.video_filename %}
                <div class="text-muted small">ğŸ¥ {{ e.video_filename }}</div>
              {% endif %}
            </div>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>

</div>

<style>
.glass{
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 16px;
}
</style>
{% endblock %}
