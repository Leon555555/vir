{% extends "layout.html" %}
{% block title %}Panel Entrenador ‚Äî VR Training{% endblock %}

{% block content %}
<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
    <div>
      <h2 class="text-light mb-1">üß† Panel Entrenador</h2>
      <div class="text-muted">Rutinas ¬∑ Banco ¬∑ Atletas</div>
    </div>

    <div class="d-flex gap-2">
      <a class="btn btn-outline-info" href="{{ url_for('main.admin_nuevo_atleta') }}">‚ûï Crear atleta</a>
      <a class="btn btn-outline-light" href="{{ url_for('main.coach_planificador') }}">üóìÔ∏è Ir al Planificador</a>
    </div>
  </div>

  <div class="row g-3">
    <!-- Crear rutina -->
    <div class="col-lg-4">
      <div class="card glass p-3 lift">
        <div class="d-flex align-items-center gap-2 mb-2">
          <span class="fw-bold text-info" style="letter-spacing:.14em;">Ôºã CREAR RUTINA</span>
        </div>

        <form method="POST" action="{{ url_for('main.crear_rutina') }}">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre de rutina" required>
          <input class="form-control mb-2" name="tipo" placeholder="Tipo (Fuerza / General / etc)">
          <textarea class="form-control mb-3" name="descripcion" placeholder="Descripci√≥n (opcional)"></textarea>
          <button class="btn btn-info w-100" type="submit">Crear</button>
        </form>

        <hr class="my-3">

        <div class="fw-bold mb-2" style="letter-spacing:.14em;">üìö RUTINAS</div>
        <div class="d-flex flex-column gap-2">
          {% for r in rutinas %}
            <div class="glass p-3" style="border-radius:16px;">
              <div class="d-flex justify-content-between align-items-center gap-2">
                <div>
                  <div class="fw-bold">{{ r.nombre }}</div>
                  <div class="text-muted" style="font-size:.9rem;">{{ r.tipo or "‚Äî" }}</div>
                </div>
                <a class="btn btn-sm btn-outline-light" href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">Builder</a>
              </div>
            </div>
          {% else %}
            <div class="text-muted">Todav√≠a no hay rutinas.</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Subir ejercicio + banco -->
    <div class="col-lg-4">
      <div class="card glass p-3 lift">
        <div class="fw-bold text-info mb-2" style="letter-spacing:.14em;">üé• SUBIR EJERCICIO</div>

        <form method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre del ejercicio" required>
          <input class="form-control mb-2" name="categoria" placeholder="Categor√≠a (pierna, tir√≥n, empuje...)">
          <textarea class="form-control mb-2" name="descripcion" placeholder="Descripci√≥n (opcional)"></textarea>
          <input class="form-control mb-3" type="file" name="video" accept="video/mp4" required>
          <button class="btn btn-info w-100" type="submit">Subir</button>
        </form>

        <hr class="my-3">

        <div class="fw-bold mb-2" style="letter-spacing:.14em;">üß± BANCO</div>

        <div class="d-flex flex-column gap-2" style="max-height:420px;overflow:auto;padding-right:6px;">
          {% for e in ejercicios %}
            <div class="glass p-3" style="border-radius:16px;">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-bold">{{ e.nombre }}</div>
                  <div class="text-muted" style="font-size:.9rem;">{{ e.categoria or "‚Äî" }}</div>
                </div>
                {% if e.video_filename %}
                  <a class="btn btn-sm btn-outline-info"
                     href="{{ url_for('static', filename='videos/' ~ e.video_filename) }}"
                     target="_blank" rel="noopener">Ver video</a>
                {% endif %}
              </div>
            </div>
          {% else %}
            <div class="text-muted">No hay ejercicios todav√≠a.</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Atletas -->
    <div class="col-lg-4">
      <div class="card glass p-3 lift">
        <div class="fw-bold text-info mb-1" style="letter-spacing:.14em;">üë• ATLETAS</div>
        <div class="text-muted mb-2">Planific√° o mir√° el perfil.</div>

        <div class="d-flex flex-column gap-2">
          {% for a in atletas %}
            <div class="glass p-3" style="border-radius:16px;">
              <div class="fw-bold">{{ a.nombre }}</div>
              <div class="text-muted" style="font-size:.9rem;">{{ a.email }}</div>

              <div class="d-flex gap-2 mt-2 flex-wrap">
                <a class="btn btn-sm btn-outline-info"
                   href="{{ url_for('main.coach_planificador', user_id=a.id) }}">Planificar</a>

                <a class="btn btn-sm btn-outline-light"
                   href="{{ url_for('main.perfil_usuario', user_id=a.id) }}">Ver perfil</a>

                <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                      onsubmit="return confirm('¬øEliminar atleta {{ a.nombre }}?');">
                  <button class="btn btn-sm btn-outline-danger" type="submit">Eliminar</button>
                </form>
              </div>
            </div>
          {% else %}
            <div class="text-muted">No hay atletas todav√≠a.</div>
          {% endfor %}
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
