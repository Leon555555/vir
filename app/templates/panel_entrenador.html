{% extends "layout.html" %}
{% block title %}Panel Entrenador â€” VR Training{% endblock %}

{% block content %}
<div class="container mt-3">

  <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
    <div>
      <h2 class="mb-0 text-light">ğŸ§  Panel Entrenador</h2>
      <div class="text-muted">Rutinas Â· Banco de ejercicios Â· Atletas</div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-info" href="{{ url_for('main.coach_planificador') }}">
        ğŸ“… Ir al Planificador
      </a>
    </div>
  </div>

  <div class="row g-3">

    <!-- RUTINAS -->
    <div class="col-lg-4">
      <div class="card p-3" style="background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;">
        <h5 class="text-info mb-2">â• Crear Rutina</h5>
        <form method="POST" action="{{ url_for('main.crear_rutina') }}">
          <div class="mb-2">
            <input class="form-control" name="nombre" placeholder="Nombre de rutina" required>
          </div>
          <div class="mb-2">
            <input class="form-control" name="tipo" placeholder="Tipo (Fuerza / General / etc)">
          </div>
          <div class="mb-2">
            <textarea class="form-control" name="descripcion" rows="2" placeholder="DescripciÃ³n (opcional)"></textarea>
          </div>
          <button class="btn btn-info w-100" type="submit">Crear</button>
        </form>

        <hr style="border-color:rgba(255,255,255,.08)">

        <h5 class="text-light mb-2">ğŸ“š Rutinas</h5>
        <div class="list-group">
          {% for r in rutinas %}
            <div class="list-group-item d-flex justify-content-between align-items-center"
                 style="background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.06);color:#fff;">
              <div>
                <div class="fw-bold">{{ r.nombre }}</div>
                <div class="small text-muted">{{ r.tipo or "â€”" }}</div>
              </div>
              <a class="btn btn-sm btn-outline-light" href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">
                Builder
              </a>
            </div>
          {% else %}
            <div class="text-muted">No hay rutinas aÃºn.</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- BANCO EJERCICIOS -->
    <div class="col-lg-4">
      <div class="card p-3" style="background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;">
        <h5 class="text-info mb-2">ğŸ¥ Subir Ejercicio</h5>
        <form method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data">
          <div class="mb-2">
            <input class="form-control" name="nombre" placeholder="Nombre del ejercicio" required>
          </div>
          <div class="mb-2">
            <input class="form-control" name="categoria" placeholder="CategorÃ­a (pierna, tirÃ³n, empuje...)">
          </div>
          <div class="mb-2">
            <textarea class="form-control" name="descripcion" rows="2" placeholder="DescripciÃ³n (opcional)"></textarea>
          </div>
          <div class="mb-2">
            <input class="form-control" type="file" name="video" accept="video/*" required>
          </div>
          <button class="btn btn-info w-100" type="submit">Subir</button>
        </form>

        <hr style="border-color:rgba(255,255,255,.08)">

        <h5 class="text-light mb-2">ğŸ¦ Banco</h5>
        <div style="max-height:420px;overflow:auto;">
          {% for e in ejercicios %}
            <div class="p-2 mb-2"
                 style="border:1px solid rgba(255,255,255,.06);border-radius:12px;background:rgba(0,0,0,.25);">
              <div class="fw-bold">{{ e.nombre }}</div>
              <div class="small text-muted">{{ e.categoria or "â€”" }}</div>
              {% if e.video_filename %}
                <div class="small">
                  <a class="text-info" target="_blank"
                     href="{{ url_for('static', filename='videos/' ~ e.video_filename) }}">
                    Ver video
                  </a>
                </div>
              {% endif %}
            </div>
          {% else %}
            <div class="text-muted">No hay ejercicios aÃºn.</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- ATLETAS -->
    <div class="col-lg-4">
      <div class="card p-3" style="background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;">
        <h5 class="text-info mb-2">ğŸ‘¥ Atletas</h5>

        <div class="text-muted small mb-2">
          PodÃ©s planificar en: <b>Planificador</b> â†’ elegÃ­s atleta.
        </div>

        <div style="max-height:520px;overflow:auto;">
          {% for a in atletas %}
            <div class="d-flex justify-content-between align-items-center gap-2 p-2 mb-2"
                 style="border:1px solid rgba(255,255,255,.06);border-radius:12px;background:rgba(0,0,0,.25);">
              <div>
                <div class="fw-bold">{{ a.nombre }}</div>
                <div class="small text-muted">{{ a.email }}</div>
              </div>

              <div class="d-flex gap-2">
                <a class="btn btn-sm btn-outline-info"
                   href="{{ url_for('main.coach_planificador', user_id=a.id) }}">
                  Planificar
                </a>

                <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                      onsubmit="return confirm('Â¿Eliminar atleta y sus datos?');">
                  <button class="btn btn-sm btn-outline-danger" type="submit">Eliminar</button>
                </form>
              </div>
            </div>
          {% else %}
            <div class="text-muted">No hay atletas.</div>
          {% endfor %}
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
