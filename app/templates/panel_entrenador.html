{% extends "layout.html" %}
{% block title %}Dashboard Entrenador ‚Äî VR Training{% endblock %}

{% block content %}
<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
    <div>
      <h2 class="text-light mb-0">üèãÔ∏è‚Äç‚ôÇÔ∏è Dashboard Entrenador</h2>
      <div class="text-soft">Rutinas, banco de ejercicios y atletas.</div>
    </div>

    <div class="d-flex gap-2 flex-wrap">
      <a class="btn btn-info" href="{{ url_for('main.admin_nuevo_atleta') }}">‚ûï Crear atleta</a>
      <a class="btn btn-outline-info" href="{{ url_for('main.coach_planificador') }}">üìÖ Planificador</a>
    </div>
  </div>

  <div class="row g-3">

    <!-- Atletas -->
    <div class="col-lg-6">
      <div class="card glass p-3 p-md-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="fw-bold">Atletas</div>
          <span class="badge bg-secondary">{{ atletas|length }}</span>
        </div>

        {% if atletas %}
          <div class="d-flex flex-column gap-2">
            {% for a in atletas %}
              <div class="glass p-3" style="border-radius:16px;">
                <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
                  <div>
                    <div class="fw-bold">{{ a.nombre }}</div>
                    <div class="text-soft" style="font-size:.92rem;">{{ a.email }}</div>
                    {% if a.grupo %}
                      <div class="mt-1"><span class="badge bg-info">{{ a.grupo }}</span></div>
                    {% endif %}
                  </div>

                  <div class="d-flex gap-2 flex-wrap">
                    <a class="btn btn-sm btn-outline-info"
                       href="{{ url_for('main.perfil_usuario', user_id=a.id) }}">
                      Ver perfil
                    </a>

                    <a class="btn btn-sm btn-outline-light"
                       href="{{ url_for('main.coach_planificador', user_id=a.id) }}">
                      Planificar
                    </a>

                    <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                          onsubmit="return confirm('¬øEliminar atleta?');">
                      <button class="btn btn-sm btn-outline-danger" type="submit">Eliminar</button>
                    </form>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="empty-state text-soft">Todav√≠a no hay atletas.</div>
        {% endif %}
      </div>
    </div>

    <!-- Rutinas -->
    <div class="col-lg-6">
      <div class="card glass p-3 p-md-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="fw-bold">Rutinas</div>
          <span class="badge bg-secondary">{{ rutinas|length }}</span>
        </div>

        <form method="POST" action="{{ url_for('main.crear_rutina') }}" class="row g-2 mb-3">
          <div class="col-md-6">
            <input class="form-control" name="nombre" placeholder="Nombre rutina" required>
          </div>
          <div class="col-md-3">
            <input class="form-control" name="tipo" placeholder="Tipo (Fuerza/Run)">
          </div>
          <div class="col-md-3 d-grid">
            <button class="btn btn-info" type="submit">Crear</button>
          </div>
          <div class="col-12">
            <input class="form-control" name="descripcion" placeholder="Descripci√≥n (opcional)">
          </div>
        </form>

        {% if rutinas %}
          <div class="d-flex flex-column gap-2">
            {% for r in rutinas %}
              <div class="glass p-3" style="border-radius:16px;">
                <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
                  <div>
                    <div class="fw-bold">{{ r.nombre }}</div>
                    <div class="text-soft" style="font-size:.92rem;">{{ r.tipo or '‚Äî' }}</div>
                  </div>
                  <a class="btn btn-sm btn-outline-info"
                     href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">
                    Builder
                  </a>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="empty-state text-soft">Todav√≠a no hay rutinas.</div>
        {% endif %}
      </div>
    </div>

    <!-- Banco ejercicios -->
    <div class="col-12">
      <div class="card glass p-3 p-md-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="fw-bold">Banco de ejercicios</div>
          <span class="badge bg-secondary">{{ ejercicios|length }}</span>
        </div>

        <form method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data"
              class="row g-2">
          <div class="col-md-3">
            <input class="form-control" name="nombre" placeholder="Nombre ejercicio" required>
          </div>
          <div class="col-md-2">
            <input class="form-control" name="categoria" placeholder="Categor√≠a">
          </div>
          <div class="col-md-3">
            <input class="form-control" name="descripcion" placeholder="Descripci√≥n">
          </div>
          <div class="col-md-3">
            <input class="form-control" type="file" name="video" accept="video/*" required>
          </div>
          <div class="col-md-1 d-grid">
            <button class="btn btn-info" type="submit">Subir</button>
          </div>
        </form>

      </div>
    </div>

  </div>
</div>
{% endblock %}
