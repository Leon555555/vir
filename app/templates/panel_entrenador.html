{% extends "layout.html" %}
{% block title %}Panel Entrenador{% endblock %}

{% block content %}
<div class="container-fluid mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="text-strong mb-0">ðŸ§  Panel Entrenador</h2>
      <div class="text-soft">Rutinas Â· Banco Â· Atletas</div>
    </div>
    <a class="btn btn-outline-info" href="{{ url_for('main.coach_planificador') }}">ðŸ“… Ir al Planificador</a>
  </div>

  <div class="row g-4">

    <!-- CREAR RUTINA -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="section-title">âž• Crear rutina</h5>

        <form method="POST" action="{{ url_for('main.crear_rutina') }}" class="mb-3">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre de rutina">
          <input class="form-control mb-2" name="tipo" placeholder="Tipo (Fuerza / General / etc)">
          <textarea class="form-control mb-2" name="descripcion" placeholder="DescripciÃ³n (opcional)"></textarea>
          <button class="btn btn-info w-100" type="submit">Crear</button>
        </form>

        <hr>

        <h5 class="section-title">ðŸ“š Rutinas</h5>
        {% for r in rutinas %}
          <div class="item-row mb-2">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <div class="text-strong">{{ r.nombre }}</div>
                <div class="text-soft">{{ r.tipo or 'â€”' }}</div>
              </div>
              <a class="btn btn-sm btn-outline-light" href="{{ url_for('main.rutina_builder', rutina_id=r.id) }}">Builder</a>
            </div>
          </div>
        {% else %}
          <div class="text-soft">No hay rutinas todavÃ­a.</div>
        {% endfor %}
      </div>
    </div>

    <!-- SUBIR EJERCICIO -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="section-title">ðŸŽ¥ Subir ejercicio</h5>

        <form method="POST" action="{{ url_for('main.admin_nuevo_ejercicio') }}" enctype="multipart/form-data" class="mb-3">
          <input class="form-control mb-2" name="nombre" placeholder="Nombre del ejercicio">
          <input class="form-control mb-2" name="categoria" placeholder="CategorÃ­a (pierna, tirÃ³n, empuje...)">
          <textarea class="form-control mb-2" name="descripcion" placeholder="DescripciÃ³n (opcional)"></textarea>
          <input class="form-control mb-2" type="file" name="video" accept="video/mp4,video/webm,video/quicktime">
          <button class="btn btn-info w-100" type="submit">Subir</button>
        </form>

        <hr>

        <h5 class="section-title">ðŸ§± Banco</h5>
        <div style="max-height:420px; overflow:auto; padding-right:6px;">
          {% for e in ejercicios %}
            <div class="item-row mb-2">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <div class="text-strong">{{ e.nombre }}</div>
                  <div class="text-soft">{{ e.categoria or '' }}</div>
                </div>
                {% if e.video_filename %}
                  <a class="btn btn-sm btn-outline-info" href="{{ url_for('static', filename='videos/' ~ e.video_filename) }}" target="_blank">
                    Ver video
                  </a>
                {% endif %}
              </div>
            </div>
          {% else %}
            <div class="text-soft">No hay ejercicios todavÃ­a.</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- ATLETAS -->
    <div class="col-lg-4">
      <div class="card glass p-3">
        <h5 class="section-title">ðŸ‘¥ Atletas</h5>
        <div class="text-soft mb-2">PlanificÃ¡ o mirÃ¡ el perfil.</div>

        {% for a in atletas %}
          <div class="item-row mb-2">
            <div class="d-flex justify-content-between align-items-center gap-2 flex-wrap">
              <div>
                <div class="text-strong">{{ a.nombre }}</div>
                <div class="text-soft">{{ a.email }}</div>
              </div>

              <div class="d-flex gap-2">
                <a class="btn btn-sm btn-outline-info" href="{{ url_for('main.coach_planificador', user_id=a.id) }}">Planificar</a>
                <a class="btn btn-sm btn-outline-light" href="{{ url_for('main.perfil_usuario', user_id=a.id, view='today') }}">Ver perfil</a>

                <form method="POST" action="{{ url_for('main.admin_delete_user', user_id=a.id) }}"
                      onsubmit="return confirm('Â¿Eliminar atleta {{ a.nombre }}?');">
                  <button class="btn btn-sm btn-outline-danger" type="submit">Eliminar</button>
                </form>
              </div>
            </div>
          </div>
        {% else %}
          <div class="text-soft">No hay atletas.</div>
        {% endfor %}
      </div>
    </div>

  </div>
</div>
{% endblock %}
